<div class="product-detail-wrapper" *ngIf="product$ | async as product">
    <div class="container">
        <!-- Breadcrumb -->
        <nav class="breadcrumb-nav">
            <a routerLink="/" class="breadcrumb-link">
                <i class="fas fa-home"></i> Home
            </a>
            <i class="fas fa-chevron-right"></i>
            <a routerLink="/catalog" class="breadcrumb-link">Products</a>
            <i class="fas fa-chevron-right"></i>
            <span class="breadcrumb-current">{{ product.name }}</span>
        </nav>

        <div class="product-detail-grid">
            <!-- Image Gallery Section -->
            <div class="image-section">
                <div class="main-image-container">
                    <img [src]="product.imageUrl ? product.imageUrl : 'assets/placeholder.png'" [alt]="product.name"
                        class="main-image">
                    <div class="image-overlay" *ngIf="product.status !== 'Available'">
                        <span class="status-watermark" *ngIf="product.status === 'Sold'">
                            <i class="fas fa-ban"></i> SOLD OUT
                        </span>
                        <span class="status-watermark" *ngIf="product.status === 'Hidden'">
                            <i class="fas fa-eye-slash"></i> HIDDEN
                        </span>
                    </div>
                </div>

                <!-- Trust Badges -->
                <div class="trust-badges">
                    <div class="trust-badge">
                        <i class="fas fa-shield-alt"></i>
                        <span>Secure Payment</span>
                    </div>
                    <div class="trust-badge">
                        <i class="fas fa-undo"></i>
                        <span>7-Day Return</span>
                    </div>
                    <div class="trust-badge">
                        <i class="fas fa-truck"></i>
                        <span>Fast Delivery</span>
                    </div>
                </div>
            </div>

            <!-- Product Info Section -->
            <div class="info-section">
                <!-- Category & Date Badge -->
                <div class="meta-badges">
                    <span class="category-badge" *ngIf="product.category?.name">
                        <i class="fas fa-tag"></i> {{ product.category?.name }}
                    </span>
                    <span class="date-badge">
                        <i class="far fa-clock"></i> {{ product.createdDate | date:'mediumDate' }}
                    </span>
                </div>

                <!-- Product Name -->
                <h1 class="product-title">{{ product.name }}</h1>

                <!-- Price Section -->
                <div class="price-section">
                    <div class="price-container">
                        <span class="current-price">{{ product.price | currency:'VND':'symbol':'1.0-0' }}</span>
                        <div class="price-details"
                            *ngIf="product.originalPrice && product.originalPrice > product.price">
                            <span class="original-price">
                                {{ product.originalPrice | currency:'VND':'symbol':'1.0-0' }}
                            </span>
                            <span class="discount-badge">
                                <i class="fas fa-tag"></i>
                                -{{ ((product.originalPrice - product.price) / product.originalPrice) | percent:'1.0-0'
                                }} OFF
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Status Badges -->
                <div class="status-badges">
                    <span class="condition-badge">
                        <i class="fas fa-star"></i>
                        Condition: {{ product.condition }}
                    </span>
                    <span class="availability-badge" [class.available]="product.status === 'Available'"
                        [class.sold-out]="product.status === 'Sold'">
                        <i class="fas" [class.fa-check-circle]="product.status === 'Available'"
                            [class.fa-times-circle]="product.status === 'Sold'"></i>
                        {{ product.status }}
                    </span>
                </div>

                <!-- Description -->
                <div class="description-section">
                    <h3 class="section-title">
                        <i class="fas fa-align-left"></i> Description
                    </h3>
                    <p class="description-text">{{ product.description }}</p>
                </div>

                <!-- Product Details Table -->
                <div class="details-section">
                    <h3 class="section-title">
                        <i class="fas fa-info-circle"></i> Product Details
                    </h3>
                    <div class="details-grid">
                        <div class="detail-item">
                            <span class="detail-label">Condition:</span>
                            <span class="detail-value">{{ product.condition }}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Status:</span>
                            <span class="detail-value">{{ product.status }}</span>
                        </div>
                        <div class="detail-item" *ngIf="product.category?.name">
                            <span class="detail-label">Category:</span>
                            <span class="detail-value">{{ product.category?.name }}</span>
                        </div>
                        <div class="detail-item" *ngIf="product.size">
                            <span class="detail-label">Size:</span>
                            <span class="detail-value">{{ product.size }}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Posted:</span>
                            <span class="detail-value">{{ product.createdDate | date:'medium' }}</span>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="action-section">
                    <button *ngIf="product.status === 'Available'" (click)="addToCart(product)" class="btn-add-to-cart">
                        <i class="fas fa-cart-plus"></i>
                        <span>Add to Cart</span>
                        <div class="button-shine"></div>
                    </button>
                    <button *ngIf="product.status === 'Sold'" disabled class="btn-sold-out">
                        <i class="fas fa-ban"></i>
                        <span>Sold Out</span>
                    </button>
                    <button routerLink="/catalog" class="btn-continue">
                        <i class="fas fa-shopping-bag"></i>
                        <span>Continue Shopping</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Loading State -->
<div class="loading-container" *ngIf="!(product$ | async)">
    <div class="spinner"></div>
    <p>Loading product details...</p>
</div>